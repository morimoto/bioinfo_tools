============== -*- outline -*- ==============

		bioinfo_tools

2021/03/22	Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
=============================================

* 何これ？

	某研究者から bioinformatics 関連のツールを作って欲しいと
	依頼を受けて作っているやつ

* ライセンス

	GNU General Public License v2

* MAC ユーザー

	MAC の sed (BSD sed) の改行の扱いが相当ややこしいので
	MAC ユーザーは GNU sed を使ってください

		> brew install gnu-sed

* mo_dfast_to_cdspickup.sh

	https://dfast.ddbj.nig.ac.jp/
	http://kazumaxneo.hatenablog.com/entry/2019/10/10/073000
	https://github.com/nigyta/dfast_core

	上記の Dfast は
		A) RARx-METABAT__x/protein.faa
		B) RARx-METABAT__x/genome.gbk
	A) に説明を添えた B) を作成する

	mo_dfast_to_cdspickup は B) の CDS の /note の中に特定のキーワードを含んでいるものを
	A) からピックアップするために、中間ファイルである mo_cdspickup_xxx.xls を作る
	(xxx は指定したキーワード)。

	以下は "AmoA" と言うキーワードを全フォルダ (= RAR*) からピックアップする例

		> ls
		RAR1-METABAT__1  RAR2-METABAT__2  RAR3-METABAT__3 ...

		> mo_dfast_to_cdspickup.sh AmoA RAR*

	上記例の場合、実行後に mo_cdspickup_AmoA.xls と言うファイルができる。
	確認のためこのファイルを MS Office 等で開き余計なものが含まれていないか等を確認する。
	余計なものが含まれている場合は、その行を削除する。
	確認・編集後、「CSV 形式」または「テキスト（タブ）形式」で保存する。
	保存したファイルを使い、次の mo_cdspickup_to_faa.sh を使用する事で、
	特定のキーワード含んだ新しい protein.faa を作成する

* mo_cdspickup_to_faa

	mo_dfast_to_cdspickup により作成された mo_cdspickup_xx ファイルを元に
	新しい protein.faa を作成する

	以下は "AmoA" と言うキーワードを全フォルダ (= RAR*) からピックアップした
	mo_cdspickup_AmoA.xls （テキスト（タブ）形式）を元に全フォルダ内にある
	protein.faa からキーワードを含む情報だけをピックアップする。

		> ls
		RAR1-METABAT__1  RAR2-METABAT__2  RAR3-METABAT__3 ...

		> mo_cdspickup_to_faa.sh mo_cdspickup_AmoA.xls RAR*

	上記の例の実行後、mo_protein.faa が作成される

* mo_merge_orthology_to_faa.pl

	--- sample.txt ---
	...
	MGA_6|YTPLAS18_00060    K02469
	MGA_7|YTPLAS18_00070    K03664
	MGA_8|YTPLAS18_00080
	...
	MGA_3816|YTPLAS72_37540
	MGA_3817|YTPLAS72_37550   K07714
	MGA_3818|YTPLAS72_37560
	...
	MGA_1|defluvii_00010      K02313
	MGA_2|defluvii_00020      K02338
	MGA_3|defluvii_00030      K02470
	MGA_4|defluvii_00040      K02469
	...

	--- KO_Orthology_xxx.txt ---
	09100 Metabolism	09101 Carbohydrate metabolism	00010 Glycolysis / Gluconeogenesis [PATH:ko00010]	K00844  HK; hexokinase [EC:2.7.1.1]
	09100 Metabolism	09101 Carbohydrate metabolism	00010 Glycolysis / Gluconeogenesis [PATH:ko00010]	K12407  GCK; glucokinase [EC:2.7.1.2]
	09100 Metabolism	09101 Carbohydrate metabolism	00010 Glycolysis / Gluconeogenesis [PATH:ko00010]	K00845  glk; glucokinase [EC:2.7.1.2]
	...
	-------------------

	上記のような以下のような 2 つのファイルをマージして、
	以下のようなファイルを作る。
	Kxxxx が複数の意味を持つ場合、行が増える

	-------------------
	...
	MGA_6|YTPLAS18_00060    K02469	09100 Metabolism	09101 Carbohydrate metabolism...
	MGA_6|YTPLAS18_00060    K02469	09100 Metabolism	09101 Carbohydrate metabolism...
	MGA_7|YTPLAS18_00070    K03664	09180 Brite Hierarchies	09182 Protein families ...
	MGA_7|YTPLAS18_00070    K03664	09180 Brite Hierarchies	09182 Protein families ...
	MGA_7|YTPLAS18_00070    K03664	09180 Brite Hierarchies	09182 Protein families ...
	MGA_8|YTPLAS18_00080
	...
	MGA_3816|YTPLAS72_37540
	MGA_3817|YTPLAS72_37550   K07714	09100 Metabolism	09101 Carbohydrate metabolism...
	MGA_3817|YTPLAS72_37550   K07714	09180 Brite Hierarchies	09182 Protein families ...
	MGA_3817|YTPLAS72_37550   K07714	09180 Brite Hierarchies	09182 Protein families ...
	MGA_3818|YTPLAS72_37560
	...
	-------------------

	ex)
		mo_merge_orthology_to_faa.pl sample.txt KO_Orthology_xxx.txt > /tmp/hoge

* mo_analysis.sh

	-------------------
	MGA_2|NED1_00010
	MGA_3|NED1_00020	K06925
	MGA_4|NED1_00030	K00259
	...
	MGA_11|NED2_00110
	MGA_12|NED2_00120	K04065
	MGA_13|NED2_00130	K01480
	...
	MGA_12|NED3_00110	K01284
	MGA_13|NED3_00120
	MGA_14|NED3_00130
	...
	-------------------

	上記のようなファイルから、Core, Singleton 等の情報を解析する

	> mo_analysis.sh  sample.txt

	summary
		Total  genes		(a)全遺伝子数（入力ファイルの行数）
		Genes with K No		(b)全遺伝子に付与された K No の数
		  rate (genes)		(b) * 100 / (a)
		Uniq K No		全 K No をユニークにした数
		Total Core		(x)全コアの数
		  rate (genes)		(x) * 100 / (a)
		  rate (K No)		(x) * 100 / (b)
		Total Singleton		(y)全シングルトンの数
		  rate (genes)		(y) * 100 / (a)
		  rate (K No)		(y) * 100 / (b)

	各ゲノムフォルダ

		all_genes.tsv		各ゲノムの全遺伝し数
		all_k_no.tsv		各ゲノムに付与された K No の数
		uniq_k.tsv		all_k_no の内容をユニークにしたもの　出現個数付き
		singleton.tsv		Singleton の Kxxx
		summary.tsv
			Total  genes		(1)全ゲノム数 (all_genes.tsv の行数)
			Genes with K No		(2)Kxxxx の数 (all_k_no.tsv  の行数)
			  rate (genes)		(2) * 100 / (1)
			Uniq K No		Kxxx をユニークにした数
			Singleton		(3)シングルトンの数
			  rate (genes)		(3) * 100 / (1)
			  rate (K No)		(3) * 100 / (2)

	core フォルダ

		uniq_core.tsv		全コア　出現個数付き
		summary.tsv
			Total  core	(x)全コア数（uniq_core.tsv の行数）
			SCG (9/9)	(y)9 ゲノム中 9 個がシングルの数
			  rate (9/9)    (y) * 100 / (x)
			SCG (8/9)       (z)9 ゲノム中 8 個がシングルの数
			  rate (8/9)    (z) * 100 / (x)
			...
